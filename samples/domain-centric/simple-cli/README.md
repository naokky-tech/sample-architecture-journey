# ドメイン中心アーキテクチャ（Clean / Hexagonal / DDD） ─ シンプルCLIサンプル

このディレクトリは、Zenn 連載「フクロウと学ぶアーキテクチャ」シリーズの **第2回：ドメイン中心アーキテクチャ（Clean / Hexagonal / DDD）** 対応サンプルです。

レイヤード版と同じ「タスク管理」のミニアプリですが、

- **ドメイン（core）** がアプリケーションの中心  
- **外側の詳細（CLI・永続化など）は Adapter として周辺に置く**  
- 依存方向は **外側 → 内側** の一方向のみ  

という構造になっています。

---

## 🔧 動かし方

以下を実行します：

```bash
cd samples/domain-centric/simple-cli
python src/main.py
```

CLI メニューが表示されます。

- `1`…タスクを追加  
- `2`…タスク一覧を表示  
- `3`…タスクを完了済みにする  
- `0`…終了  

Python 標準ライブラリのみで動作します。

---

## 🧱 アーキテクチャ構成

```
src/
  main.py                # コンポジションルート（依存の組み立て）
  core/                  # アプリケーションの中心（ドメイン・ユースケース）
    entities.py          # ドメインモデル（Task など）
    ports.py             # ポート（インターフェース）＝ドメイン視点の依存先
    use_cases.py         # ユースケース（アプリケーションサービス）
  adapters/              # 外側の世界（入出力・永続化など）
    in_memory_task_repository.py  # ポートを実装したインメモリリポジトリ
    cli/
      controller.py      # CLI からユースケースを呼び出すアダプタ
```

---

## 🔍 依存の向きと意図

### core（ドメイン）は何にも依存しない

- ビジネスルールとユースケースのみ  
- CLI や DB の存在を知らない  
- 外側がどう変わっても core は変えない

### adapters（外側の世界）は core に依存

- CLI・DB・外部サービスなど  
- core の ports（インターフェース）を実装する

### main（composition root）

- ユースケースとアダプタを組み立ててアプリを起動するだけ

これにより、

- **外側が変わっても内側（ドメイン）は安定する**
- いくつでも入出力（CLI, Web API, Test）を増やせる

という、ドメイン中心アーキテクチャらしい構造が体験できます。

---

## 🧪 試してみるポイント

- `core/entities.py` にドメインルール（例: 空タイトル禁止）を追加  
- 永続化を `InMemory → ファイル保存版` に差し替える  
- CLI を Web API（FastAPI など）に置き換える  

など、**core を変えずに外側を差し替えられる設計**を意識してみてください。
